{"version":3,"sources":["../../../../ts/js/products-list/model/processor/default.ts"],"names":["DefaultProcessor","fetchDeferred","resourceUrlManager","fetchProducts","serviceUrl","getInstance","getLazyProducts","length","get","done","result","setLazyProducts","resolve","reject","promise"],"mappings":";;;MAKqBA,gB;;;AAKjB,gCAAc;AAAA,WAFNC,aAEM,GAF6B,uBAE7B;AACV,WAAKC,kBAAL,GAA0B,yBAA1B;AACH;;;;AAED;;;WAGAC,a,GAAA,yBAAgB;AACZ,UAAIF,aAAa,GAAG,KAAKA,aAAzB;AACA,UAAIG,UAAU,GAAG,KAAKF,kBAAL,CAAwBC,aAAxB,EAAjB;;AAEA,UAAI,UAAcE,WAAd,GAA4BC,eAA5B,GAA8CC,MAA9C,KAAyD,CAA7D,EAAgE;AAC5D,iBAAQC,GAAR,CAAYJ,UAAZ,EAAwBK,IAAxB,CAA6B,UAAUC,MAAV,EAAuB;AAChD,oBAAcL,WAAd,GAA4BM,eAA5B,CAA4CD,MAA5C;;AACAT,UAAAA,aAAa,CAACW,OAAd;AACH,SAHD;AAIH,OALD,MAKO;AACHX,QAAAA,aAAa,CAACY,MAAd;AACH;;AAED,aAAOZ,aAAa,CAACa,OAArB;AACH,K","sourcesContent":["import ResourceUrlManager from \"../resource-url-manager\";\nimport storage from \"mage/storage\"\nimport ProductsState from \"../../state/products\";\nimport deferred, {DeferredInterface} from \"../../../utils/promise-deferred\";\n\nexport default class DefaultProcessor\n{\n    private resourceUrlManager: ResourceUrlManager;\n    private fetchDeferred: DeferredInterface = deferred();\n\n    constructor() {\n        this.resourceUrlManager = new ResourceUrlManager();\n    };\n\n    /**\n     *  Method saves products to the state and returns a promise\n     */\n    fetchProducts() {\n        let fetchDeferred = this.fetchDeferred;\n        let serviceUrl = this.resourceUrlManager.fetchProducts();\n\n        if (ProductsState.getInstance().getLazyProducts().length === 0) {\n            storage.get(serviceUrl).done(function (result: any) {\n                ProductsState.getInstance().setLazyProducts(result);\n                fetchDeferred.resolve();\n            });\n        } else {\n            fetchDeferred.reject();\n        }\n\n        return fetchDeferred.promise;\n    }\n}\n"],"file":"default.js"}